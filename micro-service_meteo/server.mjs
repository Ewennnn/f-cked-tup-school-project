'use strict';

import Hapi from '@hapi/hapi';
import {weatherController} from "./controller/weatherController.mjs";

const routes =[
    {
        method: 'GET',
        path: '/test',
        handler: async (req, res) => {
            const response = {"city":{"insee":"44109","cp":44000,"name":"Nantes","latitude":47.2316,"longitude":-1.5483,"altitude":18},"update":"2023-04-14T09:14:22+02:00","forecast":[[{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":0,"period":0,"datetime":"2023-04-14T02:00:00+0200","temp2m":8,"wind10m":5,"gust10m":26,"dirwind10m":265,"rr10":0.1,"rr1":0.1,"probarain":90,"weather":10,"probafrost":0,"probafog":0,"probawind70":0,"probawind100":0,"gustx":26},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":0,"period":1,"datetime":"2023-04-14T08:00:00+0200","temp2m":8,"wind10m":15,"gust10m":48,"dirwind10m":246,"rr10":5.5,"rr1":10,"probarain":100,"weather":10,"probafrost":0,"probafog":0,"probawind70":0,"probawind100":0,"gustx":69},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":0,"period":2,"datetime":"2023-04-14T14:00:00+0200","temp2m":14,"wind10m":30,"gust10m":61,"dirwind10m":251,"rr10":4.7,"rr1":9.5,"probarain":100,"weather":40,"probafrost":0,"probafog":0,"probawind70":0,"probawind100":0,"gustx":76},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":0,"period":3,"datetime":"2023-04-14T20:00:00+0200","temp2m":12,"wind10m":20,"gust10m":59,"dirwind10m":276,"rr10":0.1,"rr1":0.1,"probarain":70,"weather":40,"probafrost":0,"probafog":0,"probawind70":0,"probawind100":0,"gustx":59}],[{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":1,"period":0,"datetime":"2023-04-15T02:00:00+0200","temp2m":9,"wind10m":15,"gust10m":41,"dirwind10m":290,"rr10":0,"rr1":0,"probarain":20,"weather":3,"probafrost":0,"probafog":0,"probawind70":0,"probawind100":0,"gustx":41},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":1,"period":1,"datetime":"2023-04-15T08:00:00+0200","temp2m":8,"wind10m":15,"gust10m":41,"dirwind10m":332,"rr10":0,"rr1":0,"probarain":10,"weather":3,"probafrost":0,"probafog":0,"probawind70":0,"probawind100":0,"gustx":41},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":1,"period":2,"datetime":"2023-04-15T14:00:00+0200","temp2m":15,"wind10m":20,"gust10m":44,"dirwind10m":338,"rr10":0,"rr1":0,"probarain":10,"weather":1,"probafrost":0,"probafog":0,"probawind70":0,"probawind100":0,"gustx":44},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":1,"period":3,"datetime":"2023-04-15T20:00:00+0200","temp2m":13,"wind10m":10,"gust10m":40,"dirwind10m":343,"rr10":0,"rr1":0,"probarain":10,"weather":2,"probafrost":0,"probafog":0,"probawind70":0,"probawind100":0,"gustx":40}],[{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":2,"period":0,"datetime":"2023-04-16T02:00:00+0200","temp2m":5,"wind10m":5,"gust10m":16,"dirwind10m":68,"rr10":0,"rr1":0,"probarain":0,"weather":2,"probafrost":10,"probafog":10,"probawind70":0,"probawind100":0,"gustx":16},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":2,"period":1,"datetime":"2023-04-16T08:00:00+0200","temp2m":5,"wind10m":5,"gust10m":14,"dirwind10m":107,"rr10":0,"rr1":0,"probarain":0,"weather":2,"probafrost":10,"probafog":10,"probawind70":0,"probawind100":0,"gustx":14},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":2,"period":2,"datetime":"2023-04-16T14:00:00+0200","temp2m":16,"wind10m":5,"gust10m":16,"dirwind10m":334,"rr10":0,"rr1":0,"probarain":0,"weather":3,"probafrost":0,"probafog":20,"probawind70":0,"probawind100":0,"gustx":16},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":2,"period":3,"datetime":"2023-04-16T20:00:00+0200","temp2m":12,"wind10m":5,"gust10m":17,"dirwind10m":320,"rr10":0,"rr1":0,"probarain":0,"weather":4,"probafrost":0,"probafog":20,"probawind70":0,"probawind100":0,"gustx":17}],[{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":3,"period":0,"datetime":"2023-04-17T02:00:00+0200","temp2m":10,"wind10m":5,"gust10m":14,"dirwind10m":326,"rr10":0,"rr1":0,"probarain":10,"weather":5,"probafrost":10,"probafog":20,"probawind70":0,"probawind100":0,"gustx":14},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":3,"period":1,"datetime":"2023-04-17T08:00:00+0200","temp2m":9,"wind10m":10,"gust10m":20,"dirwind10m":117,"rr10":1.5,"rr1":1.5,"probarain":50,"weather":10,"probafrost":10,"probafog":0,"probawind70":0,"probawind100":0,"gustx":20},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":3,"period":2,"datetime":"2023-04-17T14:00:00+0200","temp2m":14,"wind10m":10,"gust10m":23,"dirwind10m":76,"rr10":0.2,"rr1":0.5,"probarain":50,"weather":10,"probafrost":0,"probafog":0,"probawind70":0,"probawind100":0,"gustx":23},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":3,"period":3,"datetime":"2023-04-17T20:00:00+0200","temp2m":10,"wind10m":15,"gust10m":27,"dirwind10m":36,"rr10":0,"rr1":0,"probarain":50,"weather":3,"probafrost":0,"probafog":0,"probawind70":0,"probawind100":0,"gustx":27}],[{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":4,"period":0,"datetime":"2023-04-18T02:00:00+0200","temp2m":7,"wind10m":15,"gust10m":30,"dirwind10m":42,"rr10":0,"rr1":0,"probarain":10,"weather":1,"probafrost":10,"probafog":0,"probawind70":0,"probawind100":0,"gustx":30},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":4,"period":1,"datetime":"2023-04-18T08:00:00+0200","temp2m":6,"wind10m":20,"gust10m":30,"dirwind10m":54,"rr10":0,"rr1":0,"probarain":0,"weather":1,"probafrost":10,"probafog":0,"probawind70":0,"probawind100":0,"gustx":30},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":4,"period":2,"datetime":"2023-04-18T14:00:00+0200","temp2m":15,"wind10m":25,"gust10m":30,"dirwind10m":56,"rr10":0.2,"rr1":0.2,"probarain":60,"weather":40,"probafrost":0,"probafog":0,"probawind70":0,"probawind100":0,"gustx":40},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":4,"period":3,"datetime":"2023-04-18T20:00:00+0200","temp2m":11,"wind10m":20,"gust10m":33,"dirwind10m":45,"rr10":0.5,"rr1":0.5,"probarain":60,"weather":40,"probafrost":0,"probafog":0,"probawind70":10,"probawind100":0,"gustx":40}],[{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":5,"period":0,"datetime":"2023-04-19T02:00:00+0200","temp2m":7,"wind10m":20,"gust10m":30,"dirwind10m":47,"rr10":0,"rr1":0,"probarain":10,"weather":1,"probafrost":10,"probafog":0,"probawind70":0,"probawind100":0,"gustx":30},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":5,"period":1,"datetime":"2023-04-19T08:00:00+0200","temp2m":6,"wind10m":20,"gust10m":30,"dirwind10m":63,"rr10":0,"rr1":0,"probarain":10,"weather":3,"probafrost":10,"probafog":0,"probawind70":0,"probawind100":0,"gustx":30},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":5,"period":2,"datetime":"2023-04-19T14:00:00+0200","temp2m":15,"wind10m":20,"gust10m":28,"dirwind10m":67,"rr10":0.2,"rr1":2,"probarain":60,"weather":41,"probafrost":0,"probafog":0,"probawind70":0,"probawind100":0,"gustx":40},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":5,"period":3,"datetime":"2023-04-19T20:00:00+0200","temp2m":12,"wind10m":15,"gust10m":28,"dirwind10m":56,"rr10":1,"rr1":3,"probarain":60,"weather":40,"probafrost":0,"probafog":0,"probawind70":0,"probawind100":0,"gustx":34}],[{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":6,"period":0,"datetime":"2023-04-20T02:00:00+0200","temp2m":8,"wind10m":15,"gust10m":27,"dirwind10m":65,"rr10":0,"rr1":0,"probarain":40,"weather":1,"probafrost":10,"probafog":0,"probawind70":0,"probawind100":0,"gustx":27},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":6,"period":1,"datetime":"2023-04-20T08:00:00+0200","temp2m":7,"wind10m":20,"gust10m":27,"dirwind10m":79,"rr10":0,"rr1":0,"probarain":10,"weather":3,"probafrost":10,"probafog":0,"probawind70":0,"probawind100":0,"gustx":27},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":6,"period":2,"datetime":"2023-04-20T14:00:00+0200","temp2m":16,"wind10m":20,"gust10m":25,"dirwind10m":82,"rr10":0.2,"rr1":0.2,"probarain":50,"weather":40,"probafrost":0,"probafog":0,"probawind70":0,"probawind100":0,"gustx":35},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":6,"period":3,"datetime":"2023-04-20T20:00:00+0200","temp2m":13,"wind10m":15,"gust10m":27,"dirwind10m":67,"rr10":1,"rr1":1,"probarain":60,"weather":40,"probafrost":0,"probafog":0,"probawind70":0,"probawind100":0,"gustx":31}],[{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":7,"period":0,"datetime":"2023-04-21T02:00:00+0200","temp2m":9,"wind10m":15,"gust10m":30,"dirwind10m":76,"rr10":0,"rr1":0,"probarain":40,"weather":3,"probafrost":0,"probafog":0,"probawind70":0,"probawind100":0,"gustx":30},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":7,"period":1,"datetime":"2023-04-21T08:00:00+0200","temp2m":8,"wind10m":15,"gust10m":27,"dirwind10m":90,"rr10":0,"rr1":0,"probarain":30,"weather":3,"probafrost":0,"probafog":0,"probawind70":0,"probawind100":0,"gustx":27},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":7,"period":2,"datetime":"2023-04-21T14:00:00+0200","temp2m":17,"wind10m":20,"gust10m":23,"dirwind10m":96,"rr10":0,"rr1":0,"probarain":50,"weather":3,"probafrost":0,"probafog":0,"probawind70":0,"probawind100":0,"gustx":23},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":7,"period":3,"datetime":"2023-04-21T20:00:00+0200","temp2m":13,"wind10m":15,"gust10m":24,"dirwind10m":70,"rr10":0.2,"rr1":0.2,"probarain":60,"weather":40,"probafrost":0,"probafog":0,"probawind70":0,"probawind100":0,"gustx":34}],[{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":8,"period":0,"datetime":"2023-04-22T02:00:00+0200","temp2m":10,"wind10m":15,"gust10m":25,"dirwind10m":87,"rr10":0,"rr1":0,"probarain":30,"weather":3,"probafrost":0,"probafog":0,"probawind70":0,"probawind100":0,"gustx":25},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":8,"period":1,"datetime":"2023-04-22T08:00:00+0200","temp2m":9,"wind10m":15,"gust10m":25,"dirwind10m":103,"rr10":0,"rr1":0,"probarain":40,"weather":3,"probafrost":0,"probafog":0,"probawind70":0,"probawind100":0,"gustx":25},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":8,"period":2,"datetime":"2023-04-22T14:00:00+0200","temp2m":17,"wind10m":15,"gust10m":23,"dirwind10m":133,"rr10":0.2,"rr1":0.2,"probarain":50,"weather":40,"probafrost":0,"probafog":0,"probawind70":0,"probawind100":0,"gustx":31},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":8,"period":3,"datetime":"2023-04-22T20:00:00+0200","temp2m":13,"wind10m":10,"gust10m":20,"dirwind10m":53,"rr10":0.5,"rr1":3,"probarain":60,"weather":40,"probafrost":0,"probafog":0,"probawind70":0,"probawind100":0,"gustx":30}],[{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":9,"period":0,"datetime":"2023-04-23T02:00:00+0200","temp2m":10,"wind10m":10,"gust10m":21,"dirwind10m":91,"rr10":0,"rr1":0,"probarain":50,"weather":3,"probafrost":0,"probafog":0,"probawind70":0,"probawind100":0,"gustx":21},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":9,"period":1,"datetime":"2023-04-23T08:00:00+0200","temp2m":9,"wind10m":15,"gust10m":21,"dirwind10m":117,"rr10":0,"rr1":0,"probarain":50,"weather":3,"probafrost":0,"probafog":0,"probawind70":0,"probawind100":0,"gustx":21},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":9,"period":2,"datetime":"2023-04-23T14:00:00+0200","temp2m":16,"wind10m":15,"gust10m":20,"dirwind10m":221,"rr10":0.7,"rr1":5,"probarain":60,"weather":41,"probafrost":0,"probafog":0,"probawind70":0,"probawind100":0,"gustx":35},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":9,"period":3,"datetime":"2023-04-23T20:00:00+0200","temp2m":13,"wind10m":10,"gust10m":18,"dirwind10m":308,"rr10":1.2,"rr1":3,"probarain":60,"weather":40,"probafrost":0,"probafog":10,"probawind70":0,"probawind100":0,"gustx":18}],[{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":10,"period":0,"datetime":"2023-04-24T02:00:00+0200","temp2m":9,"wind10m":10,"gust10m":15,"dirwind10m":62,"rr10":0,"rr1":0,"probarain":50,"weather":3,"probafrost":0,"probafog":10,"probawind70":0,"probawind100":0,"gustx":15},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":10,"period":1,"datetime":"2023-04-24T08:00:00+0200","temp2m":9,"wind10m":10,"gust10m":16,"dirwind10m":68,"rr10":0.2,"rr1":0.2,"probarain":50,"weather":40,"probafrost":0,"probafog":10,"probawind70":0,"probawind100":0,"gustx":16},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":10,"period":2,"datetime":"2023-04-24T14:00:00+0200","temp2m":16,"wind10m":15,"gust10m":20,"dirwind10m":43,"rr10":1.2,"rr1":3.2,"probarain":60,"weather":40,"probafrost":0,"probafog":0,"probawind70":0,"probawind100":0,"gustx":30},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":10,"period":3,"datetime":"2023-04-24T20:00:00+0200","temp2m":13,"wind10m":10,"gust10m":18,"dirwind10m":353,"rr10":1.2,"rr1":6,"probarain":60,"weather":41,"probafrost":0,"probafog":10,"probawind70":0,"probawind100":0,"gustx":18}],[{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":11,"period":0,"datetime":"2023-04-25T02:00:00+0200","temp2m":9,"wind10m":10,"gust10m":15,"dirwind10m":50,"rr10":0,"rr1":0,"probarain":40,"weather":3,"probafrost":0,"probafog":10,"probawind70":0,"probawind100":0,"gustx":15},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":11,"period":1,"datetime":"2023-04-25T08:00:00+0200","temp2m":8,"wind10m":10,"gust10m":15,"dirwind10m":57,"rr10":0,"rr1":0,"probarain":50,"weather":3,"probafrost":0,"probafog":20,"probawind70":0,"probawind100":0,"gustx":15},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":11,"period":2,"datetime":"2023-04-25T14:00:00+0200","temp2m":15,"wind10m":15,"gust10m":18,"dirwind10m":58,"rr10":1.2,"rr1":3.2,"probarain":60,"weather":40,"probafrost":0,"probafog":0,"probawind70":0,"probawind100":0,"gustx":18},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":11,"period":3,"datetime":"2023-04-25T20:00:00+0200","temp2m":13,"wind10m":15,"gust10m":21,"dirwind10m":31,"rr10":2,"rr1":4,"probarain":60,"weather":40,"probafrost":0,"probafog":0,"probawind70":0,"probawind100":0,"gustx":31}],[{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":12,"period":0,"datetime":"2023-04-26T02:00:00+0200","temp2m":9,"wind10m":10,"gust10m":21,"dirwind10m":51,"rr10":0,"rr1":0,"probarain":50,"weather":3,"probafrost":0,"probafog":0,"probawind70":0,"probawind100":0,"gustx":21},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":12,"period":1,"datetime":"2023-04-26T08:00:00+0200","temp2m":8,"wind10m":15,"gust10m":21,"dirwind10m":58,"rr10":0.2,"rr1":2,"probarain":60,"weather":41,"probafrost":0,"probafog":0,"probawind70":0,"probawind100":0,"gustx":36},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":12,"period":2,"datetime":"2023-04-26T14:00:00+0200","temp2m":15,"wind10m":15,"gust10m":21,"dirwind10m":51,"rr10":1.5,"rr1":3.5,"probarain":60,"weather":40,"probafrost":0,"probafog":0,"probawind70":0,"probawind100":0,"gustx":31},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":12,"period":3,"datetime":"2023-04-26T20:00:00+0200","temp2m":13,"wind10m":15,"gust10m":21,"dirwind10m":28,"rr10":1.2,"rr1":6,"probarain":60,"weather":41,"probafrost":0,"probafog":0,"probawind70":0,"probawind100":0,"gustx":36}],[{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":13,"period":0,"datetime":"2023-04-27T02:00:00+0200","temp2m":9,"wind10m":15,"gust10m":21,"dirwind10m":52,"rr10":0,"rr1":0,"probarain":50,"weather":3,"probafrost":0,"probafog":0,"probawind70":0,"probawind100":0,"gustx":21},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":13,"period":1,"datetime":"2023-04-27T08:00:00+0200","temp2m":8,"wind10m":15,"gust10m":21,"dirwind10m":55,"rr10":0.2,"rr1":0.2,"probarain":50,"weather":40,"probafrost":0,"probafog":0,"probawind70":0,"probawind100":0,"gustx":31},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":13,"period":2,"datetime":"2023-04-27T14:00:00+0200","temp2m":15,"wind10m":15,"gust10m":23,"dirwind10m":49,"rr10":1.2,"rr1":6,"probarain":60,"weather":41,"probafrost":0,"probafog":0,"probawind70":0,"probawind100":0,"gustx":38},{"insee":"44109","cp":44000,"latitude":47.2316,"longitude":-1.5483,"day":13,"period":3,"datetime":"2023-04-27T20:00:00+0200","temp2m":12,"wind10m":15,"gust10m":21,"dirwind10m":359,"rr10":1.2,"rr1":5,"probarain":60,"weather":41,"probafrost":0,"probafog":0,"probawind70":0,"probawind100":0,"gustx":36}]]} 
            return res.response(response)
        } 
    },
    {
        method: 'GET',
        path: '/weather',
        handler: async (req, res) => {
            return res.response(await "{message: \"good weather\"}")
        }
    }
]

const server = Hapi.server({
    port: 3001,
    host: 'localhost'
});

server.route(routes);

export const init = async () => {

    await server.initialize();
    return server;
};

export const start = async () => {
    await server.start();
    console.log(`Server running at: ${server.info.uri}`);
    return server;
};


process.on('unhandledRejection', (err) => {

    console.log(err);
    process.exit(1);
});



